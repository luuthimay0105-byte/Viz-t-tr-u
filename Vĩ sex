local player = game.Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local hum = char:WaitForChild("Humanoid")
local root = char:WaitForChild("HumanoidRootPart")

-- UI
local gui = script.Parent
local main = gui.Main
local toggle = gui.Toggle

local flyBtn = main.FlyButton
local upBtn = main.SpeedUp
local downBtn = main.SpeedDown

-- Menu toggle
toggle.MouseButton1Click:Connect(function()
	main.Visible = not main.Visible
end)

-- Speed
local speed = 16
hum.WalkSpeed = speed

upBtn.MouseButton1Click:Connect(function()
	speed += 5
	hum.WalkSpeed = speed
end)

downBtn.MouseButton1Click:Connect(function()
	speed = math.max(5, speed - 5)
	hum.WalkSpeed = speed
end)

-- Fly
local flying = false
local bv, bg

local function startFly()
	flying = true

	bv = Instance.new("BodyVelocity")
	bv.MaxForce = Vector3.new(1e5,1e5,1e5)
	bv.Velocity = Vector3.zero
	bv.Parent = root

	bg = Instance.new("BodyGyro")
	bg.MaxTorque = Vector3.new(1e5,1e5,1e5)
	bg.CFrame = root.CFrame
	bg.Parent = root
end

local function stopFly()
	flying = false
	if bv then bv:Destroy() end
	if bg then bg:Destroy() end
end

flyBtn.MouseButton1Click:Connect(function()
	if flying then
		stopFly()
		flyBtn.Text = "FLY"
	else
		startFly()
		flyBtn.Text = "STOP FLY"
	end
end)
